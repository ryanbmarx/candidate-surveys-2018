{% extends "templates/_base-elex.html" %}

{# {% set categories = candidates|get_unique_values('race_category') %} #}
{% set offices = candidates|get_unique_values('race_office') %}

{% block content %}
	{{ super() }}
	<section id='intro' class='intro container'>
		<div class='river'>
			{{ intro|markdown }}
			{% if bedsheet_text and bedsheet_link != False %}
				<p><a href="http://{{ ROOT_URL }}/{{bedsheet_link}}">{{ bedsheet_text }}</a></p>
			{% endif %}
			<form id='candidate-lookup' class='candidate-lookup'>
				<input type='text' placeholder="Search for a candidate" />
				<button type='submit'>Search</button>
			</form>
			<dl class='races-legend'>
				<dt>{{ endorsed('default') }}</dt>
				<dd>= Endorsed by Chicago Tribune</dd>
			</dl>
		</div>
	</section>
	{% include "subtemplates/_buttons.html" %}	
	<section id='content' class='content container'>
		<div class='row'>
			<div class='races'>
				{% for category in control|sort(attribute="order") if category.Status|lower == "on" %}
					<div id={{ category.id|lower }} class='category category--{{ category.id|lower }}'>
					{{ stars_topper(category.label) }}
					{% for office in offices %}
						{# Check if any candidates are in the category > office #}
						{% if candidates|has_any(category.id, office) %}
							<div class='office office--{{ office|lower|slugify }}'>
								<h5>{{ office }}</h5>
								{% include 'subtemplates/_opponents-list.html'%}
							</div>
							{% endif %}
					{% endfor %}
					</div>
					{{ refer() }}
				{% endfor %}
			</div>
			<div class='editorials'>
				{{stars_topper('editorials')}}
				<div class='editorials__col'>
					{# <div class="advert" data-ad-type="shrinky-cube"></div> #}
					{% include 'subtemplates/_editorials.html' %}
				</div>
			</div>
		</div>
	</section>
{% endblock content %}

{% block library_scripts %}
	{{ super() }}
	<script src="//{{ ROOT_URL }}/js/vendor.min.js" type="text/javascript"></script>
	<script>
		{# // We'll use this to power the autocomplete #}
		window.ROOT_URL = "http://{{ ROOT_URL }}";
		window.candidates = {{ candidates|generate_autocomplete_list|tojson }}
	</script>
{% endblock %}


{% block scripts %}
	{{ super() }}
	<script src="//{{ ROOT_URL }}/js/app.min.js" type="text/javascript"></script>
{% endblock %}

{% block comments %}{% endblock %}